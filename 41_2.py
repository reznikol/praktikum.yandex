# 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
# 2. –≠—Ç–æ –∑–∞–¥–∞–Ω–∏–µ ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ. –í –Ω—ë–º –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ –ê–Ω—Ñ–∏—Å—É –º–∞—Å—Ç–µ—Ä–æ–º –Ω–∞ –≤—Å–µ —Ä—É–∫–∏. –ê–Ω—Ñ–∏—Å–∞ –±—É–¥–µ—Ç –∑–Ω–∞—Ç—å –≤—Å—ë –ø—Ä–æ –≤–∞—à–∏—Ö –¥—Ä—É–∑–µ–π ‚Äî –≥–¥–µ –æ–Ω–∏, —Å–∫–æ–ª—å–∫–æ —É –Ω–∏—Ö –≤—Ä–µ–º–µ–Ω–∏, –∏ –∫–∞–∫–∞—è —É –Ω–∏—Ö –ø–æ–≥–æ–¥–∞.
# –í —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ queries –≤ —Ñ—É–Ω–∫—Ü–∏–∏ runner() –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ –ø–æ–≥–æ–¥—É:
# –ö–æ–ª—è, –∫–∞–∫ –ø–æ–≥–æ–¥–∞?
# –°–æ–Ω—è, –∫–∞–∫ –ø–æ–≥–æ–¥–∞?
# –ê–Ω—Ç–æ–Ω, –∫–∞–∫ –ø–æ–≥–æ–¥–∞?
# –ù–∞—É—á–∏—Ç–µ –ê–Ω—Ñ–∏—Å—É –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Ç–∞–∫–æ–≥–æ –≤–∏–¥–∞. –î–ª—è —ç—Ç–æ–≥–æ:
# –î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é process_friend() –æ–±—Ä–∞–±–æ—Ç–∫—É –µ—â—ë –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ '–∫–∞–∫ –ø–æ–≥–æ–¥–∞?'. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ city ‚Äî —ç—Ç–æ –≥–æ—Ä–æ–¥, –≤ –∫–æ—Ç–æ—Ä–æ–º –∂–∏–≤—ë—Ç –¥—Ä—É–≥.
# –ó–∞—Ç–µ–º –≤—ã–∑–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é what_weather() ‚Äî –≤—ã –Ω–∞–ø–∏—Å–∞–ª–∏ –Ω–∞ –ø—Ä–æ—à–ª–æ–º —É—Ä–æ–∫–µ –ø–æ—á—Ç–∏ —Ç–∞–∫—É—é –∂–µ. –û–Ω–∞ —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –∫–æ–¥–µ —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.
# –í–µ—Ä–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç process_friend().

import datetime as dt
import requests
DATABASE = {
    '–°–µ—Ä–≥–µ–π': '–û–º—Å–∫',
    '–°–æ–Ω—è': '–ú–æ—Å–∫–≤–∞',
    '–ê–ª–µ–∫—Å–µ–π': '–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥',
    '–ú–∏—à–∞': '–ú–æ—Å–∫–≤–∞',
    '–î–∏–º–∞': '–ß–µ–ª—è–±–∏–Ω—Å–∫',
    '–ê–ª–∏–Ω–∞': '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫',
    '–ï–≥–æ—Ä': '–ü–µ—Ä–º—å',
    '–ö–æ–ª—è': '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫',
    '–ê—Ä—Ç—ë–º': '–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫',
    '–ü–µ—Ç—è': '–ú–∏—Ö–∞–π–ª–æ–≤–∫–∞'
}
UTC_OFFSET = {
    '–ú–æ—Å–∫–≤–∞': 3,
    '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥': 3,
    '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫': 7,
    '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': 5,
    '–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥': 3,
    '–ö–∞–∑–∞–Ω—å': 3,
    '–ß–µ–ª—è–±–∏–Ω—Å–∫': 5,
    '–û–º—Å–∫': 6,
    '–°–∞–º–∞—Ä–∞': 4,
    '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É': 3,
    '–£—Ñ–∞': 5,
    '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫': 7,
    '–í–æ—Ä–æ–Ω–µ–∂': 3,
    '–ü–µ—Ä–º—å': 5,
    '–í–æ–ª–≥–æ–≥—Ä–∞–¥': 4,
    '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä': 3,
    '–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥': 2,
    '–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫': 10
}
def format_count_friends(count_friends):
    if count_friends == 1:
        return '1 –¥—Ä—É–≥'
    elif 2 <= count_friends <= 4:
        return f'{count_friends} –¥—Ä—É–≥–∞'
    else:
        return f'{count_friends} –¥—Ä—É–∑–µ–π'
def what_time(city):
    offset = UTC_OFFSET[city]
    city_time = dt.datetime.utcnow() + dt.timedelta(hours=offset)
    f_time = city_time.strftime("%H:%M")
    return f_time
def what_weather(city):
    url = f'http://wttr.in/{city}'
    weather_parameters = {
        'format': 2,
        'M': ''
    }
    try:
        response = requests.get(url, params=weather_parameters)
    except requests.ConnectionError:
        return '<—Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞>'
    if response.status_code == 200:
        return response.text.strip()
    else:
        return '<–æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ–≥–æ–¥—ã>'
def process_anfisa(query):
    if query == '—Å–∫–æ–ª—å–∫–æ —É –º–µ–Ω—è –¥—Ä—É–∑–µ–π?':
        count_string = format_count_friends(len(DATABASE))
        return f'–£ —Ç–µ–±—è {count_string}'
    elif query == '–∫—Ç–æ –≤—Å–µ –º–æ–∏ –¥—Ä—É–∑—å—è?':
        friends_string = ', '.join(DATABASE.keys())
        return f'–¢–≤–æ–∏ –¥—Ä—É–∑—å—è: {friends_string}'
    elif query == '–≥–¥–µ –≤—Å–µ –º–æ–∏ –¥—Ä—É–∑—å—è?':
        unique_cities = set(DATABASE.values())
        cities_string = ', '.join(unique_cities)
        return f'–¢–≤–æ–∏ –¥—Ä—É–∑—å—è –≤ –≥–æ—Ä–æ–¥–∞—Ö: {cities_string}'
    else:
        return '<–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å>'
def process_friend(name, query):
    if name in DATABASE:
        city = DATABASE[name]
        if query == '—Ç—ã –≥–¥–µ?':
            return f'{name} –≤ –≥–æ—Ä–æ–¥–µ {city}'
        elif query == '–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å?':
            if city not in UTC_OFFSET:
                return f'<–Ω–µ –º–æ–≥—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –≤ –≥–æ—Ä–æ–¥–µ {city}>'
            time = what_time(city)
            return f'–¢–∞–º —Å–µ–π—á–∞—Å {time}'
        elif query == '–∫–∞–∫ –ø–æ–≥–æ–¥–∞?':
            if city in DATABASE[name]:
                return what_weather(city)     
        else:
            return '<–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å>'
    else:
        return f'–£ —Ç–µ–±—è –Ω–µ—Ç –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∏ {name}'
def process_query(query):
    tokens = query.split(', ')
    name = tokens[0]
    if name == '–ê–Ω—Ñ–∏—Å–∞':
        return process_anfisa(tokens[1])
    else:
        return process_friend(name, tokens[1])
def runner():
    queries = [
        '–ê–Ω—Ñ–∏—Å–∞, —Å–∫–æ–ª—å–∫–æ —É –º–µ–Ω—è –¥—Ä—É–∑–µ–π?',
        '–ê–Ω—Ñ–∏—Å–∞, –∫—Ç–æ –≤—Å–µ –º–æ–∏ –¥—Ä—É–∑—å—è?',
        '–ê–Ω—Ñ–∏—Å–∞, –≥–¥–µ –≤—Å–µ –º–æ–∏ –¥—Ä—É–∑—å—è?',
        '–ê–Ω—Ñ–∏—Å–∞, –∫—Ç–æ –≤–∏–Ω–æ–≤–∞—Ç?',
        '–ö–æ–ª—è, —Ç—ã –≥–¥–µ?',
        '–°–æ–Ω—è, —á—Ç–æ –¥–µ–ª–∞—Ç—å?',
        '–ê–Ω—Ç–æ–Ω, —Ç—ã –≥–¥–µ?',
        '–ê–ª–µ–∫—Å–µ–π, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å?',
        '–ê—Ä—Ç—ë–º, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å?',
        '–ê–Ω—Ç–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å?',
        '–ü–µ—Ç—è, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å?',
        '–ö–æ–ª—è, –∫–∞–∫ –ø–æ–≥–æ–¥–∞?',
        '–°–æ–Ω—è, –∫–∞–∫ –ø–æ–≥–æ–¥–∞?',
        '–ê–Ω—Ç–æ–Ω, –∫–∞–∫ –ø–æ–≥–æ–¥–∞?'
    ]
    for query in queries:
        print(query, '-', process_query(query))
runner()

# –†–µ–∑—É–ª—å—Ç–∞—Ç
# –ê–Ω—Ñ–∏—Å–∞, —Å–∫–æ–ª—å–∫–æ —É –º–µ–Ω—è –¥—Ä—É–∑–µ–π? - –£ —Ç–µ–±—è 10 –¥—Ä—É–∑–µ–π
# –ê–Ω—Ñ–∏—Å–∞, –∫—Ç–æ –≤—Å–µ –º–æ–∏ –¥—Ä—É–∑—å—è? - –¢–≤–æ–∏ –¥—Ä—É–∑—å—è: –°–µ—Ä–≥–µ–π, –°–æ–Ω—è, –ê–ª–µ–∫—Å–µ–π, –ú–∏—à–∞, –î–∏–º–∞, –ê–ª–∏–Ω–∞, –ï–≥–æ—Ä, –ö–æ–ª—è, –ê—Ä—Ç—ë–º, –ü–µ—Ç—è
# –ê–Ω—Ñ–∏—Å–∞, –≥–¥–µ –≤—Å–µ –º–æ–∏ –¥—Ä—É–∑—å—è? - –¢–≤–æ–∏ –¥—Ä—É–∑—å—è –≤ –≥–æ—Ä–æ–¥–∞—Ö: –ß–µ–ª—è–±–∏–Ω—Å–∫, –û–º—Å–∫, –ü–µ—Ä–º—å, –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫, –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥, –ú–æ—Å–∫–≤–∞, –ú–∏—Ö–∞–π–ª–æ–≤–∫–∞, –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫
# –ê–Ω—Ñ–∏—Å–∞, –∫—Ç–æ –≤–∏–Ω–æ–≤–∞—Ç? - <–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å>
# –ö–æ–ª—è, —Ç—ã –≥–¥–µ? - –ö–æ–ª—è –≤ –≥–æ—Ä–æ–¥–µ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫
# –°–æ–Ω—è, —á—Ç–æ –¥–µ–ª–∞—Ç—å? - <–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å>
# –ê–Ω—Ç–æ–Ω, —Ç—ã –≥–¥–µ? - –£ —Ç–µ–±—è –Ω–µ—Ç –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∏ –ê–Ω—Ç–æ–Ω
# –ê–ª–µ–∫—Å–µ–π, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å? - –¢–∞–º —Å–µ–π—á–∞—Å 13:46
# –ê—Ä—Ç—ë–º, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å? - –¢–∞–º —Å–µ–π—á–∞—Å 21:46
# –ê–Ω—Ç–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å? - –£ —Ç–µ–±—è –Ω–µ—Ç –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∏ –ê–Ω—Ç–æ–Ω
# –ü–µ—Ç—è, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å? - <–Ω–µ –º–æ–≥—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –≤ –≥–æ—Ä–æ–¥–µ –ú–∏—Ö–∞–π–ª–æ–≤–∫–∞>
# –ö–æ–ª—è, –∫–∞–∫ –ø–æ–≥–æ–¥–∞? - üå®  üå°Ô∏è-18¬∞C üå¨Ô∏è‚Üñ1.1m/s
# –°–æ–Ω—è, –∫–∞–∫ –ø–æ–≥–æ–¥–∞? - ‚õÖÔ∏è  üå°Ô∏è+1¬∞C üå¨Ô∏è‚Üó5.3m/s
# –ê–Ω—Ç–æ–Ω, –∫–∞–∫ –ø–æ–≥–æ–¥–∞? - –£ —Ç–µ–±—è –Ω–µ—Ç –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∏ –ê–Ω—Ç–æ–Ω